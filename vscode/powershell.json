{
    "Phil-CmdletFull": {
        "prefix": "Phil-CmdletFull",
        "body": [
            "function ${name:Test-Cmdlet}",
            "{",
            "\t<#",
            "\t.SYNOPSIS",
            "\t\tTBC - Short description",
            "\t.DESCRIPTION",
            "\t\tTBC - Long description",
            "\t.EXAMPLE",
            "\t\tTBC - Example of how to use this cmdlet",
            "\t.INPUTS",
            "\t\tTBC - Inputs to this cmdlet (if any)",
            "\t.OUTPUTS",
            "\t\tTBC - Output from this cmdlet (if any)",
            "\t.LINK",
            "\t\tTBC - Link(s) relevant to this cmdlet",
            "",
            "\t[CmdletBinding(DefaultParameterSetName = \"DefaultParameters\", ConfirmImpact = \"Medium\",  SupportsShouldProcess = \\$True, PositionalBinding = \\$False, HelpUri = \"http://www.microsoft.com/\")]",
            "\t[Alias()]",
            "\t[OutputType([String])]",
            "\tparam",
            "\t(",
            "\t\t[Parameter(Mandatory = \\$True, Position = 0, ValueFromPipelineByPropertyName = \\$True, ValueFromPipeline = \\$True, ParameterSetName = \"DefaultParameters\", HelpMessage = \"What to enter for this parameter\")]",
            "\t\t[String[]] \\$List",
            "\t)",
            "",
            "\tBEGIN",
            "\t{",
            "\t\tif (\\$PSBoundParameters.ContainsKey(\"Debug\"))",
            "\t\t{",
            "\t\t\t\\$DebugPreference = \"Continue\"",
            "\t\t}",
            "\t\tWrite-Debug -Message \"BEGIN Block\"",
            "\t}",
            "",
            "\tPROCESS",
            "\t{",
            "\t\tWrite-Debug -Message \"PROCESS Block\"",
            "\t\tforEach (\\$Thing in \\$List)",
            "\t\t{",
            "\t\t\tif (\\$PSCmdlet.ShouldProcess(\"Target\", \"Operation\"))",
            "\t\t\t{",
            "\t\t\t\ttry",
            "\t\t\t\t{",
            "\t\t\t\t\t# Do things.",
            "\t\t\t\t}",
            "\t\t\t\tcatch",
            "\t\t\t\t{",
            "\t\t\t\t\t\\$PSCmdlet.ThrowTerminatingError(\\$_)",
            "\t\t\t\t}",
            "\t\t\t}",
            "\t\t}",
            "\t}",
            "",
            "\tEND",
            "\t{",
            "\t\tWrite-Debug -Message \"END Block\"",
            "\t}",
            "}"
        ],
        "description": "A cmdlet snippet with all the trimmings."
    },
    "Phil-CmdletShort": {
        "prefix": "Phil-CmdletShort",
        "body": [
            "function ${name:Test-Cmdlet}",
            "{",
            "\t[CmdletBinding(ConfirmImpact = \"Medium\",  SupportsShouldProcess = \\$True)]",
            "\tparam",
            "\t(",
            "\t\t[Parameter(Mandatory = \\$True, Position = 0, ValueFromPipelineByPropertyName = \\$True, ValueFromPipeline = \\$True, HelpMessage = \"What to enter for this parameter\")]",
            "\t\t[String[]] \\$List",
            "\t)",
            "",
            "\tBEGIN",
            "\t{",
            "\t\tif (\\$PSBoundParameters.ContainsKey(\"Debug\"))",
            "\t\t{",
            "\t\t\t\\$DebugPreference = \"Continue\"",
            "\t\t}",
            "\t\tWrite-Debug -Message \"BEGIN Block\"",
            "\t}",
            "",
            "\tPROCESS",
            "\t{",
            "\t\tWrite-Debug -Message \"PROCESS Block\"",
            "\t\tforEach (\\$Thing in \\$List)",
            "\t\t{",
            "\t\t\tif (\\$PSCmdlet.ShouldProcess(\"Target\", \"Operation\"))",
            "\t\t\t{",
            "\t\t\t\ttry",
            "\t\t\t\t{",
            "\t\t\t\t\t# Do things.",
            "\t\t\t\t}",
            "\t\t\t\tcatch",
            "\t\t\t\t{",
            "\t\t\t\t\t\\$PSCmdlet.ThrowTerminatingError(\\$_)",
            "\t\t\t\t}",
            "\t\t\t}",
            "\t\t}",
            "\t}",
            "",
            "\tEND",
            "\t{",
            "\t\tWrite-Debug -Message \"END Block\"",
            "\t}",
            "}"
        ],
        "description": "A cmdlet snippet formatted for my preferences/habits but without all the trimmings."
    },
    "Phil-Dsc": {
        "prefix": "Phil-Dsc",
        "body": [
            "\\$Data = @{",
            "",
            "\tAllNodes = @(",
            "",
            "\t\t@{",
            "\t\t\tNodeName = \"*\"",
            "\t\t}",
            "",
            "\t\t@{",
            "\t\t\tNodeName = \"Example01\"",
            "\t\t}",
            "",
            "\t\t@{",
            "\t\t\tNodeName = \"Example02\"",
            "\t\t}",
            "\t)",
            "}",
            "",
            "configuration ${name:Test-Configuration}",
            "{",
            "",
            "\tImport-DscResource -ModuleName \"PSDesiredStateConfiguration\"",
            "",
            "\tnode \\$AllNodes.NodeName",
            "\t{",
            "\t\tFile \\$Module.Name",
            "\t\t{",
            "\t\t\tEnsure = \"Present\"",
            "\t\t\tType = \"Directory\"",
            "\t\t\tRecurse = \\$True",
            "\t\t\tSourcePath = \"\\Path\\To\\Source\"",
            "\t\t\tDestinationPath = \"\\Path\\To\\Destination\"",
            "\t\t\tChecksum = \"SHA-256\"",
            "\t\t}",
            "\t}",
            "}",
            "",
            "# Generate the MOFs",
            "${name:Test-Configuration} -Output \"\\$PSScriptRoot/MOFs\"",
            "# Uncomment below to apply the changes as soon as the MOFs are created.",
            "# Start-DscConfiguration -Path \"\\$PSScriptRoot/MOFs\" -Force -Wait -Verbose"
        ],
        "description": "My short DSC example"
    },
    "Phil-MessagingBlock": {
        "prefix": "Phil-MessagingBlock",
        "body": [
            "-Message \"[$($MyInvocation.MyCommand.Name)] 'A message goes here.\""
        ],
        "description": "A more informative default messaging block"
    },
    "Phil-ShouldProcessShort": {
        "prefix": "Phil-ShouldProcessShort",
        "body": [
            "if (\\$PSCmdlet.ShouldProcess(\"Target\", \"Operation\"))",
            "{",
            "\ttry",
            "\t{",
            "\t\t# Do things.",
            "\t}",
            "\tcatch",
            "\t{",
            "\t\t\\$PSCmdlet.ThrowTerminatingError(\\$_)",
            "\t}",
            "}"
        ],
        "description": "A two-variable ShouldProcess segment."
    },
    "Phil-ShouldProcessFull": {
        "prefix": "Phil-ShouldProcessFull",
        "body": [
            "if (\\$PSCmdlet.ShouldProcess(\"Performing the operation '$(\\$MyInvocation.MyCommand.Name)' on target '\\$Target' for '\\$Source'\",",
            "\t\t\t\t\t\t\t\"Perform the operation '$(\\$MyInvocation.MyCommand.Name)' on target '\\$Target' for '\\$Source'?\",",
            "\t\t\t\t\t\t\t\"Are you sure you want to perform this action?\"))",
            "{",
            "\ttry",
            "\t{",
            "\t\t# Do things.",
            "\t}",
            "\tcatch",
            "\t{",
            "\t\t\\$PSCmdlet.ThrowTerminatingError(\\$_)",
            "\t}",
            "}"
        ],
        "description": "A longer three-variable ShouldProcess segment."
    },
    "Phil-TryCatchCmdlet": {
        "prefix": "Phil-TryCatchCmdlet",
        "body": [
            "try",
            "{",
            "\t# Do things.",
            "}",
            "catch",
            "{",
            "\t\\$PSCmdlet.ThrowTerminatingError(\\$_)",
            "}"
        ],
        "description": "A try-catch snippet for Cmdlets."
    },
    "Phil-TryCatchSimple": {
        "prefix": "Phil-TryCatchSimple",
        "body": [
            "try",
            "{",
            "\t# Do things.",
            "}",
            "catch",
            "{",
            "\t\\$DetailedError = \"\\$(\\$_.Exception)`n\\$(\\$_.FullyQualifiedErrorId)`n\\$(\\$_.ScriptStackTrace)\"",
            "\t\\$Issues += \"  An error occurred:`n`n\\$DetailedError`n\"",
            "\tWrite-Error -Message \\$DetailedError",
            "}"
        ],
        "description": "A try-catch snippet for when $PSCmdlet isn't available."
    },
    "Phil-SMAWorkflow": {
        "prefix": "Phil-SmaWorkflow",
        "body": [
            "workflow ${name:Test-Workflow}",
            "{",
            "\t<#",
            "\t\tAuthor:       TBC",
            "\t\tCreated:      TBC",
            "\t\tModified By:  N/A",
            "\t\tModified:     N/A",
            "\t\tRunbook type: Process/Component",
            "\t\tLink:         TBC",
            "",
            "\t\tFunction Summary - TBC",
            "\t#>",
            "",
            "\tparam",
            "\t(",
            "\t)",
            "",
            "\t\\$ErrorActionPreference = \"Stop\"",
            "\t\\$VerbosePreference = \"Continue\"",
            "",
            "\t\\$InlineOutput = InlineScript",
            "\t{",
            "\t\t\\$ErrorActionPreference = [System.Management.Automation.ActionPreference] \\$Using:ErrorActionPreference",
            "\t\t\\$VerbosePreference = [System.Management.Automation.ActionPreference] \\$Using:VerbosePreference",
            "\t\t\\$Issues = \\$Null",
            "",
            "\t\ttry",
            "\t\t{",
            "\t\t\t# Do things.",
            "\t\t}",
            "\t\tcatch",
            "\t\t{",
            "\t\t\t\\$DetailedError = \"\\$(\\$_.Exception)`n\\$(\\$_.FullyQualifiedErrorId)`n\\$(\\$_.ScriptStackTrace)\"",
            "\t\t\t\\$Issues += \"  An error occurred:`n`n\\$DetailedError`n\"",
            "\t\t\tWrite-Error -Message \\$DetailedError",
            "\t\t}",
            "",
            "\t\ttry",
            "\t\t{",
            "\t\t\t# Do things.",
            "\t\t}",
            "\t\tcatch",
            "\t\t{",
            "\t\t\t\\$DetailedError = \"\\$(\\$_.Exception)`n\\$(\\$_.FullyQualifiedErrorId)`n\\$(\\$_.ScriptStackTrace)\"",
            "\t\t\t\\$Issues += \"  An error occurred:`n`n\\$DetailedError`n\"",
            "\t\t\tWrite-Error -Message \\$DetailedError",
            "\t\t}",
            "",
            "\t\t[PSCustomObject]@{",
            "\t\t\tOutput = \\$Null",
            "\t\t\tErrors = \\$Issues",
            "\t\t}",
            "\t}",
            "",
            "\tif (\\$Null -ne \\$InlineOutput.Errors)",
            "\t{",
            "\t\t# Do some error reporting",
            "\t}",
            "\telse",
            "\t{",
            "\t\t# Do something else",
            "\t}",
            "}"
        ],
        "description": "An SMA workflow snippet."
    }
}